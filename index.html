<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>QR Billing System</title>
<script src="https://unpkg.com/html5-qrcode"></script>

<style>
body{margin:0;font-family:Arial;background:white}
.header{background:#0b3d91;color:white;padding:15px;text-align:center;font-size:20px}
.card{margin:10px;padding:10px;border:1px solid #ddd;border-radius:10px}
button{padding:8px 12px;margin:3px}
table{width:100%;border-collapse:collapse}
th,td{border:1px solid #000;padding:6px;text-align:center}
th{background:black;color:white}
.total{font-size:20px;text-align:center;margin-top:10px}
</style>
</head>

<body>

<div class="header">ðŸ“· QR Billing System</div>

<div class="card">
<h3>Scan Item</h3>
<div id="reader"></div>
</div>

<div class="card">
<h3>ðŸ§¾ Bill</h3>
<table>
<thead>
<tr><th>Item</th><th>Qty</th><th>â‚¹</th><th>+</th><th>-</th></tr>
</thead>
<tbody id="bill"></tbody>
</table>

<div class="total">Total â‚¹ <span id="total">0</span></div>

<button onclick="sendBill()">ðŸ“© Send Bill</button>
</div>

<script>
let cart = {};
let currentItem="", currentPrice=0;

function onScanSuccess(text){
  let parts = text.split("-");
  currentItem = parts[0];
  currentPrice = parseInt(parts[1]);

  let qty = prompt(currentItem+" â‚¹"+currentPrice+"\nQuantity?", "1");
  qty = parseInt(qty);
  if(!qty || qty<=0) return;

  if(!cart[currentItem]){
    cart[currentItem]={qty:0, price:currentPrice};
  }
  cart[currentItem].qty += qty;
  updateBill();
}

new Html5QrcodeScanner("reader",
{
 fps:10,
 qrbox:250,
 facingMode:{exact:"environment"}
}).render(onScanSuccess);

function updateBill(){
  let html="", total=0;
  for(let k in cart){
    let amt = cart[k].qty * cart[k].price;
    total += amt;
    html += `
    <tr>
      <td>${k}</td>
      <td>${cart[k].qty}</td>
      <td>${amt}</td>
      <td><button onclick="inc('${k}')">+</button></td>
      <td><button onclick="dec('${k}')">-</button></td>
    </tr>`;
  }
  document.getElementById("bill").innerHTML = html;
  document.getElementById("total").innerText = total;
}

function inc(k){ cart[k].qty++; updateBill(); }
function dec(k){
  cart[k].qty--;
  if(cart[k].qty<=0) delete cart[k];
  updateBill();
}

function sendBill(){
  let mobile = prompt("Customer Mobile Number?");
  if(!mobile) return;

  let msg="BILL:\n";
  let total=0;
  for(let k in cart){
    let amt = cart[k].qty * cart[k].price;
    total+=amt;
    msg+=`${k} x ${cart[k].qty} = â‚¹${amt}\n`;
  }
  msg+=`Total = â‚¹${total}`;

  // SMS / WhatsApp app open
  window.location.href =
  `sms:${mobile}?body=${encodeURIComponent(msg)}`;
}
</script>

</body>
</html>
